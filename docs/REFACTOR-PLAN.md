# é‡æ„å·¥ä½œè®¡åˆ’

æœ¬æ–‡æ¡£è¯¦ç»†é˜è¿°ä»å‚è€ƒé¡¹ç›® `oksai-saas-api-archi` é‡æ„åˆ°æ–°é¡¹ç›® `oksai-data-plateform` çš„å®Œæ•´å·¥ä½œè®¡åˆ’ï¼Œä½œä¸ºåç»­å¼€å‘çš„å¼•å¯¼æ–‡ä»¶ã€‚

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 é‡æ„ç›®æ ‡

å°†å‚è€ƒé¡¹ç›® `/home/arligle/oksai-saas/oksai-saas-api-archi/` é‡æ„ä¸ºç¬¦åˆæ–°è§„èŒƒçš„ä¼ä¸šçº§å¤šç§Ÿæˆ· SaaS æ•°æ®åˆ†æå¹³å°ã€‚

### 1.2 æ ¸å¿ƒæ”¹è¿›ç‚¹

| æ”¹è¿›ç»´åº¦ | åŸé¡¹ç›®é—®é¢˜ | æ–°é¡¹ç›®ç›®æ ‡ |
|:---|:---|:---|
| **å‘½åè§„èŒƒ** | ä¸ä¸€è‡´ï¼ˆPascalCase æ–‡ä»¶åï¼‰ | ç»Ÿä¸€ kebab-case + ç±»å‹åç¼€ |
| **ç¤ºä¾‹æ¨¡å—** | æ··ç”¨ order/customer | ç»Ÿä¸€ä½¿ç”¨ job ä½œä¸ºç¤ºä¾‹ |
| **æ–‡æ¡£ä½“ç³»** | åˆ†æ•£ã€ä¸å®Œæ•´ | å®Œæ•´çš„ä¸‰å±‚æ–‡æ¡£ä½“ç³» |
| **ä»£ç æ³¨é‡Š** | éƒ¨åˆ†ç¼ºå¤± | å¿…é¡»ä¸­æ–‡ TSDoc |
| **æµ‹è¯•è¦†ç›–** | å¾…å®Œå–„ | 80%+ å…¨å±€è¦†ç›–ç‡ |

### 1.3 é‡æ„åŸåˆ™

1. **æ¸è¿›å¼è¿ç§»**ï¼šæŒ‰ä¾èµ–é¡ºåºé€æ­¥è¿ç§»ï¼Œç¡®ä¿æ¯æ­¥å¯éªŒè¯
2. **è§„èŒƒä¼˜å…ˆ**ï¼šä¸¥æ ¼éµå¾ªæ–°å‘½åè§„èŒƒå’Œç¼–ç è§„èŒƒ
3. **æµ‹è¯•é©±åŠ¨**ï¼šé‡‡ç”¨ TDD æ–¹å¼ï¼Œå…ˆå†™æµ‹è¯•å†å®ç°
4. **æ–‡æ¡£åŒæ­¥**ï¼šä»£ç å’Œæ–‡æ¡£ä¿æŒä¸€è‡´

---

## äºŒã€é¡¹ç›®ç°çŠ¶

### 2.1 æ–°é¡¹ç›®çŠ¶æ€

```
oksai-data-plateform/
â”œâ”€â”€ apps/                       # âšª ç©º - å¾…åˆ›å»º
â”œâ”€â”€ libs/                       # âšª ç©º - å¾…åˆ›å»º
â”œâ”€â”€ docs/                       # âœ… å®Œæˆ - 35ä¸ªæ–‡æ¡£
â”‚   â”œâ”€â”€ archi/                  # æ¶æ„æ–‡æ¡£ (12ä¸ª)
â”‚   â”œâ”€â”€ spec/                   # ç¼–ç è§„èŒƒ (11ä¸ª)
â”‚   â””â”€â”€ testing/                # æµ‹è¯•æŒ‡å— (12ä¸ª)
â”œâ”€â”€ package.json                # âœ… å®Œæˆ
â”œâ”€â”€ pnpm-workspace.yaml         # âœ… å®Œæˆ
â”œâ”€â”€ tsconfig.base.json          # âœ… å®Œæˆ
â”œâ”€â”€ turbo.json                  # âœ… å®Œæˆ
â””â”€â”€ AGENTS.md                   # âœ… å®Œæˆ
```

### 2.2 å‚è€ƒé¡¹ç›®ç»“æ„

```
oksai-saas-api-archi/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ platform-api/           # ä¸šåŠ¡ API
â”‚   â”œâ”€â”€ platform-admin-api/     # ç®¡ç† API
â”‚   â””â”€â”€ demo-api/               # æ¼”ç¤º API
â”œâ”€â”€ libs/
â”‚   â”œâ”€â”€ domains/                # é¢†åŸŸæ¨¡å— (8ä¸ª)
â”‚   â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”œâ”€â”€ billing/
â”‚   â”‚   â”œâ”€â”€ data-ingestion/
â”‚   â”‚   â”œâ”€â”€ data-lake/
â”‚   â”‚   â”œâ”€â”€ data-warehouse/
â”‚   â”‚   â”œâ”€â”€ document/
â”‚   â”‚   â”œâ”€â”€ identity/
â”‚   â”‚   â””â”€â”€ tenant/
â”‚   â”œâ”€â”€ shared/                 # å…±äº«åŸºç¡€è®¾æ–½ (19ä¸ª)
â”‚   â”‚   â”œâ”€â”€ kernel/
â”‚   â”‚   â”œâ”€â”€ event-store/
â”‚   â”‚   â”œâ”€â”€ cqrs/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ authorization/
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ messaging/
â”‚   â”‚   â”œâ”€â”€ plugin/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ composition/            # ç»„è£…å±‚
â”‚       â””â”€â”€ app-kit/
```

---

## ä¸‰ã€æ¨¡å—ä¾èµ–å…³ç³»

### 3.1 ä¾èµ–å±‚çº§å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           åº”ç”¨å±‚ (apps/)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ platform-api    â”‚  â”‚ platform-admin  â”‚  â”‚ demo-api        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                     â”‚                     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          é¢†åŸŸå±‚ (libs/domains/)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ tenant  â”‚ â”‚identity â”‚ â”‚ billing  â”‚ â”‚ document  â”‚ â”‚ data-ingestion â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚       â”‚           â”‚           â”‚             â”‚               â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  data-lake  â”‚  data-warehouse  â”‚  ai                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å…±äº«å±‚ (libs/shared/)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        æ ¸å¿ƒå±‚ (æ— å¤–éƒ¨ä¾èµ–)                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚ kernel â”‚ â”‚ exceptions â”‚ â”‚   i18n    â”‚ â”‚   config   â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       åŸºç¡€è®¾æ–½å±‚                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚event-storeâ”‚ â”‚   cqrs   â”‚ â”‚  eda   â”‚ â”‚ context â”‚ â”‚ aggregate â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ database â”‚ â”‚ messaging â”‚ â”‚  auth  â”‚ â”‚  logger â”‚ â”‚  plugin   â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç»„è£…å±‚ (libs/composition/)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         app-kit                                   â”‚   â”‚
â”‚  â”‚  (ç»„åˆæ‰€æœ‰ shared æ¨¡å—ï¼Œæä¾›ç»Ÿä¸€è£…é…å…¥å£)                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è¿ç§»ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | æ¨¡å— | ä¾èµ– | è¯´æ˜ |
|:---:|:---|:---|:---|
| **P0-1** | `@oksai/kernel` | æ—  | æ ¸å¿ƒåŸºç±»ï¼Œæ‰€æœ‰æ¨¡å—ä¾èµ– |
| **P0-2** | `@oksai/exceptions` | kernel | å¼‚å¸¸å®šä¹‰ |
| **P0-3** | `@oksai/config` | kernel | é…ç½®ç®¡ç† |
| **P1-1** | `@oksai/context` | kernel | ç§Ÿæˆ·ä¸Šä¸‹æ–‡ |
| **P1-2** | `@oksai/event-store` | kernel, context | äº‹ä»¶å­˜å‚¨ |
| **P1-3** | `@oksai/cqrs` | kernel, event-store | å‘½ä»¤æŸ¥è¯¢åˆ†ç¦» |
| **P1-4** | `@oksai/eda` | kernel, event-store | äº‹ä»¶é©±åŠ¨ |
| **P2-1** | `@oksai/database` | config | æ•°æ®åº“ |
| **P2-2** | `@oksai/messaging` | eda | æ¶ˆæ¯é˜Ÿåˆ— |
| **P2-3** | `@oksai/auth` | context | è®¤è¯ |
| **P2-4** | `@oksai/authorization` | auth | æˆæƒ |
| **P3-1** | `@oksai/tenant` | ä»¥ä¸Šæ‰€æœ‰ | ç§Ÿæˆ·é¢†åŸŸ |
| **P3-2** | `@oksai/identity` | ä»¥ä¸Šæ‰€æœ‰, tenant | èº«ä»½é¢†åŸŸ |
| **P4-1** | `@oksai/app-kit` | ä»¥ä¸Šæ‰€æœ‰ | ç»„è£…å±‚ |
| **P5-1** | `@oksai/app/platform-api` | app-kit | ä¸šåŠ¡ API |
| **P5-2** | `@oksai/app/platform-admin-api` | app-kit | ç®¡ç† API |

---

## å››ã€åˆ†é˜¶æ®µå·¥ä½œè®¡åˆ’

### é˜¶æ®µ 0ï¼šç¯å¢ƒå‡†å¤‡ï¼ˆå·²å®Œæˆ âœ…ï¼‰

| ä»»åŠ¡ | çŠ¶æ€ | è¯´æ˜ |
|:---|:---:|:---|
| Monorepo åˆå§‹åŒ– | âœ… | pnpm workspace |
| TypeScript é…ç½® | âœ… | tsconfig.base.json |
| Turborepo é…ç½® | âœ… | turbo.json |
| pnpm é…ç½® | âœ… | .npmrc |
| æ–‡æ¡£ä½“ç³» | âœ… | 35ä¸ªæ–‡æ¡£ |

### é˜¶æ®µ 1ï¼šæ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼ˆé¢„è®¡ 3-5 å¤©ï¼‰

#### 1.1 åˆ›å»º `@oksai/kernel`

**ç›®æ ‡**ï¼šæä¾› DDD æ ¸å¿ƒåŸºç±»

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/kernel/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsconfig.build.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â”œâ”€â”€ lib/
    â”‚   â”œâ”€â”€ aggregate-root.ts              # èšåˆæ ¹åŸºç±»
    â”‚   â”œâ”€â”€ entity.ts                       # å®ä½“åŸºç±»
    â”‚   â”œâ”€â”€ value-object.ts                 # å€¼å¯¹è±¡åŸºç±»
    â”‚   â”œâ”€â”€ domain-event.ts                 # é¢†åŸŸäº‹ä»¶åŸºç±»
    â”‚   â”œâ”€â”€ domain-event.base.ts            # é¢†åŸŸäº‹ä»¶åŸºç¡€å®ç°
    â”‚   â”œâ”€â”€ result.ts                       # Result æ¨¡å¼
    â”‚   â”œâ”€â”€ unique-entity-id.ts             # å”¯ä¸€æ ‡è¯†
    â”‚   â””â”€â”€ guard.ts                        # ç±»å‹å®ˆå«
    â””â”€â”€ spec/
        â”œâ”€â”€ aggregate-root.spec.ts
        â”œâ”€â”€ entity.spec.ts
        â”œâ”€â”€ value-object.spec.ts
        â””â”€â”€ result.spec.ts
```

**æ ¸å¿ƒç±»å‹å®šä¹‰**ï¼š
```typescript
// aggregate-root.ts
export abstract class AggregateRoot<Props> extends Entity<Props> {
  private _domainEvents: DomainEvent[] = [];

  get domainEvents(): DomainEvent[] {
    return this._domainEvents;
  }

  protected addDomainEvent(event: DomainEvent): void {
    this._domainEvents.push(event);
  }

  clearDomainEvents(): void {
    this._domainEvents = [];
  }
}
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æ‰€æœ‰åŸºç±»å®ç°å®Œæˆ
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%
- [ ] TSDoc ä¸­æ–‡æ³¨é‡Šå®Œæ•´
- [ ] `pnpm build` æˆåŠŸ
- [ ] `pnpm test` å…¨éƒ¨é€šè¿‡

#### 1.2 åˆ›å»º `@oksai/exceptions`

**ç›®æ ‡**ï¼šç»Ÿä¸€å¼‚å¸¸ä½“ç³»

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/exceptions/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ domain.exception.ts             # é¢†åŸŸå¼‚å¸¸
        â”œâ”€â”€ application.exception.ts        # åº”ç”¨å¼‚å¸¸
        â”œâ”€â”€ infrastructure.exception.ts     # åŸºç¡€è®¾æ–½å¼‚å¸¸
        â”œâ”€â”€ validation.exception.ts         # éªŒè¯å¼‚å¸¸
        â”œâ”€â”€ business-rule.exception.ts      # ä¸šåŠ¡è§„åˆ™å¼‚å¸¸
        â””â”€â”€ not-found.exception.ts          # æœªæ‰¾åˆ°å¼‚å¸¸
```

#### 1.3 åˆ›å»º `@oksai/config`

**ç›®æ ‡**ï¼šé…ç½®ç®¡ç†

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/config/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ config.module.ts
        â”œâ”€â”€ config.service.ts
        â””â”€â”€ interfaces/
            â””â”€â”€ config.interface.ts
```

### é˜¶æ®µ 2ï¼šäº‹ä»¶æº¯æºåŸºç¡€è®¾æ–½ï¼ˆé¢„è®¡ 5-7 å¤©ï¼‰

#### 2.1 åˆ›å»º `@oksai/context`

**ç›®æ ‡**ï¼šå¤šç§Ÿæˆ·ä¸Šä¸‹æ–‡ç®¡ç†

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/context/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ tenant-context.ts               # ç§Ÿæˆ·ä¸Šä¸‹æ–‡
        â”œâ”€â”€ tenant-context.service.ts       # ä¸Šä¸‹æ–‡æœåŠ¡
        â”œâ”€â”€ tenant-aware.interface.ts       # ç§Ÿæˆ·æ„ŸçŸ¥æ¥å£
        â””â”€â”€ async-local-storage.provider.ts # ALS å®ç°
```

**æ ¸å¿ƒå®ç°**ï¼š
```typescript
// tenant-context.ts
export interface TenantContext {
  tenantId: string;
  userId?: string;
  correlationId?: string;
}

// tenant-context.service.ts
@Injectable()
export class TenantContextService {
  private readonly storage = new AsyncLocalStorage<TenantContext>();

  run<T>(context: TenantContext, fn: () => T): T {
    return this.storage.run(context, fn);
  }

  get(): TenantContext | undefined {
    return this.storage.getStore();
  }

  get tenantId(): string {
    return this.get()?.tenantId ?? '';
  }
}
```

#### 2.2 åˆ›å»º `@oksai/event-store`

**ç›®æ ‡**ï¼šäº‹ä»¶å­˜å‚¨æ¥å£å’Œå®ç°

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/event-store/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ ports/
        â”‚   â”œâ”€â”€ event-store.port.ts         # äº‹ä»¶å­˜å‚¨ç«¯å£
        â”‚   â””â”€â”€ outbox.port.ts              # Outbox ç«¯å£
        â”œâ”€â”€ interfaces/
        â”‚   â”œâ”€â”€ stored-event.interface.ts
        â”‚   â””â”€â”€ event-stream.interface.ts
        â”œâ”€â”€ event-store.module.ts
        â””â”€â”€ adapters/
            â””â”€â”€ postgres-event-store.adapter.ts
```

#### 2.3 åˆ›å»º `@oksai/cqrs`

**ç›®æ ‡**ï¼šCQRS åŸºç¡€è®¾æ–½

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/cqrs/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ commands/
        â”‚   â”œâ”€â”€ command.base.ts
        â”‚   â”œâ”€â”€ command-handler.base.ts
        â”‚   â”œâ”€â”€ command-bus.service.ts
        â”‚   â””â”€â”€ decorators/
        â”‚       â””â”€â”€ command-handler.decorator.ts
        â”œâ”€â”€ queries/
        â”‚   â”œâ”€â”€ query.base.ts
        â”‚   â”œâ”€â”€ query-handler.base.ts
        â”‚   â””â”€â”€ query-bus.service.ts
        â””â”€â”€ cqrs.module.ts
```

#### 2.4 åˆ›å»º `@oksai/eda`

**ç›®æ ‡**ï¼šäº‹ä»¶é©±åŠ¨æ¶æ„

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/eda/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ ports/
        â”‚   â”œâ”€â”€ event-bus.port.ts           # äº‹ä»¶æ€»çº¿ç«¯å£
        â”‚   â””â”€â”€ event-consumer.port.ts      # äº‹ä»¶æ¶ˆè´¹è€…ç«¯å£
        â”œâ”€â”€ interfaces/
        â”‚   â”œâ”€â”€ integration-event.interface.ts
        â”‚   â””â”€â”€ event-metadata.interface.ts
        â”œâ”€â”€ decorators/
        â”‚   â””â”€â”€ event-handler.decorator.ts
        â”œâ”€â”€ event-bus.module.ts
        â””â”€â”€ adapters/
            â”œâ”€â”€ kafka-event-bus.adapter.ts
            â””â”€â”€ in-memory-event-bus.adapter.ts
```

### é˜¶æ®µ 3ï¼šæ•°æ®è®¿é—®å±‚ï¼ˆé¢„è®¡ 3-5 å¤©ï¼‰

#### 3.1 åˆ›å»º `@oksai/database`

**ç›®æ ‡**ï¼šæ•°æ®åº“è®¿é—®

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/database/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ ports/
        â”‚   â””â”€â”€ database.port.ts
        â”œâ”€â”€ interfaces/
        â”‚   â””â”€â”€ database-config.interface.ts
        â”œâ”€â”€ database.module.ts
        â”œâ”€â”€ providers/
        â”‚   â”œâ”€â”€ postgres.provider.ts
        â”‚   â””â”€â”€ clickhouse.provider.ts
        â””â”€â”€ repositories/
            â””â”€â”€ base.repository.ts
```

#### 3.2 åˆ›å»º `@oksai/messaging`

**ç›®æ ‡**ï¼šæ¶ˆæ¯é˜Ÿåˆ—

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/messaging/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ ports/
        â”‚   â”œâ”€â”€ message-producer.port.ts
        â”‚   â””â”€â”€ message-consumer.port.ts
        â”œâ”€â”€ messaging.module.ts
        â””â”€â”€ adapters/
            â”œâ”€â”€ kafka.adapter.ts
            â””â”€â”€ redis.adapter.ts
```

### é˜¶æ®µ 4ï¼šå®‰å…¨å±‚ï¼ˆé¢„è®¡ 3-5 å¤©ï¼‰

#### 4.1 åˆ›å»º `@oksai/auth`

**ç›®æ ‡**ï¼šè®¤è¯

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/auth/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ ports/
        â”‚   â”œâ”€â”€ auth.port.ts
        â”‚   â””â”€â”€ token.port.ts
        â”œâ”€â”€ auth.module.ts
        â”œâ”€â”€ guards/
        â”‚   â””â”€â”€ jwt-auth.guard.ts
        â”œâ”€â”€ strategies/
        â”‚   â””â”€â”€ jwt.strategy.ts
        â””â”€â”€ decorators/
            â””â”€â”€ current-user.decorator.ts
```

#### 4.2 åˆ›å»º `@oksai/authorization`

**ç›®æ ‡**ï¼šæˆæƒ

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/shared/authorization/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ ports/
        â”‚   â””â”€â”€ permission-checker.port.ts
        â”œâ”€â”€ authorization.module.ts
        â”œâ”€â”€ guards/
        â”‚   â””â”€â”€ permissions.guard.ts
        â”œâ”€â”€ decorators/
        â”‚   â””â”€â”€ require-permissions.decorator.ts
        â””â”€â”€ casl/
            â””â”€â”€ ability.factory.ts
```

### é˜¶æ®µ 5ï¼šç¬¬ä¸€ä¸ªé¢†åŸŸæ¨¡å—ï¼ˆé¢„è®¡ 5-7 å¤©ï¼‰

#### 5.1 åˆ›å»º `@oksai/domain/tenant`

**ç›®æ ‡**ï¼šç§Ÿæˆ·é¢†åŸŸï¼ˆä½œä¸ºå…¶ä»–é¢†åŸŸçš„æ¨¡æ¿ï¼‰

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/domains/tenant/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ domain/
        â”‚   â”œâ”€â”€ model/
        â”‚   â”‚   â”œâ”€â”€ tenant.aggregate.ts
        â”‚   â”‚   â”œâ”€â”€ tenant-id.vo.ts
        â”‚   â”‚   â”œâ”€â”€ tenant-name.vo.ts
        â”‚   â”‚   â””â”€â”€ tenant-plan.vo.ts
        â”‚   â”œâ”€â”€ events/
        â”‚   â”‚   â”œâ”€â”€ tenant-created.domain-event.ts
        â”‚   â”‚   â””â”€â”€ tenant-activated.domain-event.ts
        â”‚   â”œâ”€â”€ services/
        â”‚   â”‚   â””â”€â”€ tenant-validators.domain-service.ts
        â”‚   â”œâ”€â”€ repositories/
        â”‚   â”‚   â””â”€â”€ tenant.repository.ts
        â”‚   â””â”€â”€ ports/
        â”‚       â”œâ”€â”€ primary/
        â”‚       â”‚   â””â”€â”€ tenant-command.port.ts
        â”‚       â””â”€â”€ secondary/
        â”‚           â””â”€â”€ tenant-notification.port.ts
        â”œâ”€â”€ application/
        â”‚   â”œâ”€â”€ commands/
        â”‚   â”‚   â”œâ”€â”€ create-tenant.command.ts
        â”‚   â”‚   â”œâ”€â”€ activate-tenant.command.ts
        â”‚   â”‚   â””â”€â”€ handlers/
        â”‚   â”‚       â”œâ”€â”€ create-tenant.handler.ts
        â”‚   â”‚       â””â”€â”€ activate-tenant.handler.ts
        â”‚   â”œâ”€â”€ queries/
        â”‚   â”‚   â”œâ”€â”€ get-tenant.query.ts
        â”‚   â”‚   â””â”€â”€ handlers/
        â”‚   â”‚       â””â”€â”€ get-tenant.handler.ts
        â”‚   â””â”€â”€ dto/
        â”‚       â””â”€â”€ tenant.dto.ts
        â”œâ”€â”€ infrastructure/
        â”‚   â”œâ”€â”€ persistence/
        â”‚   â”‚   â”œâ”€â”€ event-sourced-tenant.repository.ts
        â”‚   â”‚   â””â”€â”€ mappers/
        â”‚   â”‚       â””â”€â”€ tenant.mapper.ts
        â”‚   â”œâ”€â”€ projections/
        â”‚   â”‚   â””â”€â”€ tenant.projector.ts
        â”‚   â””â”€â”€ adapters/
        â”‚       â””â”€â”€ secondary/
        â”‚           â””â”€â”€ tenant-notification.adapter.ts
        â”œâ”€â”€ presentation/
        â”‚   â””â”€â”€ nest/
        â”‚       â”œâ”€â”€ tenant.controller.ts
        â”‚       â””â”€â”€ dto/
        â”‚           â””â”€â”€ create-tenant-request.dto.ts
        â””â”€â”€ tenant.module.ts
```

**TDD å¼€å‘é¡ºåº**ï¼š
1. ğŸ”´ ç¼–å†™ `tenant.aggregate.spec.ts` - èšåˆæ ¹æµ‹è¯•
2. ğŸŸ¢ å®ç° `tenant.aggregate.ts` - èšåˆæ ¹å®ç°
3. ğŸ”´ ç¼–å†™ `tenant-id.vo.spec.ts` - å€¼å¯¹è±¡æµ‹è¯•
4. ğŸŸ¢ å®ç° `tenant-id.vo.ts` - å€¼å¯¹è±¡å®ç°
5. ğŸ”´ ç¼–å†™ `create-tenant.handler.spec.ts` - å‘½ä»¤å¤„ç†å™¨æµ‹è¯•
6. ğŸŸ¢ å®ç° `create-tenant.handler.ts` - å‘½ä»¤å¤„ç†å™¨å®ç°
7. ... ä¾æ¬¡æ¨è¿›

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] é¢†åŸŸå±‚æ— å¤–éƒ¨ä¾èµ–
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] BDD åœºæ™¯é€šè¿‡
- [ ] TSDoc ä¸­æ–‡æ³¨é‡Šå®Œæ•´

### é˜¶æ®µ 6ï¼šç»„è£…å±‚ï¼ˆé¢„è®¡ 3-5 å¤©ï¼‰

#### 6.1 åˆ›å»º `@oksai/composition/app-kit`

**ç›®æ ‡**ï¼šç»Ÿä¸€è£…é…å…¥å£

**æ–‡ä»¶æ¸…å•**ï¼š
```
libs/composition/app-kit/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ lib/
        â”œâ”€â”€ app-kit.module.ts
        â”œâ”€â”€ core.module.ts
        â”œâ”€â”€ infrastructure.module.ts
        â””â”€â”€ plugins/
            â””â”€â”€ core-plugin.ts
```

### é˜¶æ®µ 7ï¼šåº”ç”¨å±‚ï¼ˆé¢„è®¡ 3-5 å¤©ï¼‰

#### 7.1 åˆ›å»º `@oksai/app/platform-api`

**ç›®æ ‡**ï¼šä¸šåŠ¡ API

**æ–‡ä»¶æ¸…å•**ï¼š
```
apps/platform-api/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsconfig.build.json
â”œâ”€â”€ nest-cli.json
â””â”€â”€ src/
    â”œâ”€â”€ main.ts
    â”œâ”€â”€ app.module.ts
    â””â”€â”€ config/
        â””â”€â”€ configuration.ts
```

---

## äº”ã€æ–‡ä»¶å‘½åå¯¹ç…§è¡¨

### 5.1 å‘½åè§„èŒƒå˜æ›´

| ç»„ä»¶ç±»å‹ | åŸé¡¹ç›®å‘½å | æ–°é¡¹ç›®å‘½å |
|:---|:---|:---|
| èšåˆæ ¹ | `Tenant.ts` | `tenant.aggregate.ts` |
| å€¼å¯¹è±¡ | `TenantId.ts` | `tenant-id.vo.ts` |
| é¢†åŸŸäº‹ä»¶ | `TenantCreated.ts` | `tenant-created.domain-event.ts` |
| å‘½ä»¤ | `CreateTenant.ts` | `create-tenant.command.ts` |
| å‘½ä»¤å¤„ç†å™¨ | `CreateTenantHandler.ts` | `create-tenant.handler.ts` |
| æŸ¥è¯¢ | `GetTenant.ts` | `get-tenant.query.ts` |
| ä»“å‚¨ | `TenantRepository.ts` | `tenant.repository.ts` |
| ä»“å‚¨å®ç° | `EventSourcedTenantRepo.ts` | `event-sourced-tenant.repository.ts` |
| é€‚é…å™¨ | `PostgresEventStore.ts` | `postgres-event-store.adapter.ts` |
| ç«¯å£ | `IEventStore.ts` | `event-store.port.ts` |
| æµ‹è¯• | `Tenant.spec.ts` | `tenant.aggregate.spec.ts` |
| Mock | `MockTenantRepo.ts` | `tenant.repository.mock.ts` |

### 5.2 ç›®å½•ç»“æ„å˜æ›´

```
# åŸé¡¹ç›®
libs/shared/kernel/src/lib/
â”œâ”€â”€ aggregate-root.ts
â”œâ”€â”€ entity.ts
â””â”€â”€ value-object.ts

# æ–°é¡¹ç›®
libs/shared/kernel/src/lib/
â”œâ”€â”€ aggregate-root.ts              # èšåˆæ ¹åŸºç±»
â”œâ”€â”€ entity.ts                      # å®ä½“åŸºç±»
â”œâ”€â”€ value-object.ts                # å€¼å¯¹è±¡åŸºç±»
â””â”€â”€ spec/
    â”œâ”€â”€ aggregate-root.spec.ts     # å•å…ƒæµ‹è¯•
    â”œâ”€â”€ entity.spec.ts
    â””â”€â”€ value-object.spec.ts
```

---

## å…­ã€è´¨é‡æ ‡å‡†

### 6.1 ä»£ç è´¨é‡

| æŒ‡æ ‡ | è¦æ±‚ |
|:---|:---|
| **å‘½åè§„èŒƒ** | 100% ç¬¦åˆ kebab-case + ç±»å‹åç¼€ |
| **TSDoc æ³¨é‡Š** | 100% å…¬å…± API æœ‰ä¸­æ–‡æ³¨é‡Š |
| **ä»£ç æ³¨é‡Š** | å…³é”®ä¸šåŠ¡é€»è¾‘æœ‰ä¸­æ–‡æ³¨é‡Š |
| **Lint** | 0 é”™è¯¯ï¼Œ0 è­¦å‘Š |
| **ç±»å‹æ£€æŸ¥** | 0 é”™è¯¯ |

### 6.2 æµ‹è¯•è´¨é‡

| å±‚çº§ | è¦†ç›–ç‡è¦æ±‚ |
|:---|:---|
| **å…¨å±€** | â‰¥ 80% |
| **é¢†åŸŸå±‚** | â‰¥ 90% |
| **åº”ç”¨å±‚** | â‰¥ 85% |
| **åŸºç¡€è®¾æ–½å±‚** | â‰¥ 75% |

### 6.3 æµ‹è¯•ç±»å‹åˆ†å¸ƒ

```
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   E2E æµ‹è¯•   â”‚  10% - å…³é”®ä¸šåŠ¡æµç¨‹
              â”‚   (æ…¢ã€å°‘)   â”‚
          â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
          â”‚     é›†æˆæµ‹è¯•         â”‚  20% - ç»„ä»¶äº¤äº’
          â”‚    (è¾ƒæ…¢ã€é€‚ä¸­)      â”‚
      â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
      â”‚         å•å…ƒæµ‹è¯•             â”‚  70% - ä¸šåŠ¡é€»è¾‘
      â”‚       (å¿«ã€å¤§é‡)             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸ƒã€å¼€å‘å·¥ä½œæµç¨‹

### 7.1 å•ä¸ªæ¨¡å—å¼€å‘æµç¨‹

```
1. åˆ›å»ºæ¨¡å—ç›®å½•ç»“æ„
   â†“
2. ç¼–å†™ package.json å’Œ tsconfig.json
   â†“
3. ğŸ”´ ç¼–å†™å¤±è´¥çš„å•å…ƒæµ‹è¯•
   â†“
4. ğŸŸ¢ ç”¨æœ€ç®€ä»£ç è®©æµ‹è¯•é€šè¿‡
   â†“
5. ğŸ”µ é‡æ„ä¼˜åŒ–
   â†“
6. ç¼–å†™ TSDoc ä¸­æ–‡æ³¨é‡Š
   â†“
7. è¿è¡Œ lint å’Œ typecheck
   â†“
8. æäº¤ä»£ç ï¼ˆè‹±æ–‡ commit messageï¼‰
```

### 7.2 æäº¤å‰æ£€æŸ¥æ¸…å•

```bash
# 1. ä»£ç æ ¼å¼åŒ–
pnpm run format:check

# 2. Lint æ£€æŸ¥
pnpm run lint

# 3. ç±»å‹æ£€æŸ¥
pnpm run typecheck

# 4. å•å…ƒæµ‹è¯•
pnpm run test:unit

# 5. æµ‹è¯•è¦†ç›–ç‡
pnpm run test:coverage

# 6. æ„å»º
pnpm run build
```

---

## å…«ã€é£é™©ä¸æ³¨æ„äº‹é¡¹

### 8.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|:---|:---|:---|
| å¾ªç¯ä¾èµ– | æ„å»ºå¤±è´¥ | ä¸¥æ ¼éµå¾ªä¾èµ–æ–¹å‘ï¼Œä½¿ç”¨ Port/Adapter |
| ç±»å‹é”™è¯¯ | è¿è¡Œæ—¶é”™è¯¯ | å¯ç”¨ strict æ¨¡å¼ï¼Œå……åˆ†æµ‹è¯• |
| å‘½åä¸ä¸€è‡´ | ç»´æŠ¤å›°éš¾ | ä»£ç å®¡æŸ¥ï¼Œä½¿ç”¨ lint è§„åˆ™ |

### 8.2 æ³¨æ„äº‹é¡¹

1. **ä¾èµ–æ–¹å‘**ï¼šå§‹ç»ˆä¿æŒ Domain â†’ Application â†’ Infrastructure â†’ Presentation
2. **é¢†åŸŸçº¯å‡€**ï¼šé¢†åŸŸå±‚ä¸èƒ½ä¾èµ–ä»»ä½•å¤–éƒ¨åº“ï¼ˆé™¤ kernelï¼‰
3. **ä¸­æ–‡æ³¨é‡Š**ï¼šæ‰€æœ‰å…¬å…± API å¿…é¡»æœ‰ä¸­æ–‡ TSDoc
4. **è‹±æ–‡æäº¤**ï¼šGit commit message å¿…é¡»ä½¿ç”¨è‹±æ–‡
5. **æµ‹è¯•å…ˆè¡Œ**ï¼šé‡‡ç”¨ TDDï¼Œå…ˆå†™æµ‹è¯•å†å®ç°

---

## ä¹ã€é‡Œç¨‹ç¢‘ä¸äº¤ä»˜ç‰©

### 9.1 é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | é¢„è®¡æ—¶é—´ | äº¤ä»˜ç‰© |
|:---|:---|:---|
| **M1: æ ¸å¿ƒåŸºç¡€è®¾æ–½** | ç¬¬ 1 å‘¨ | kernel, exceptions, config |
| **M2: äº‹ä»¶æº¯æº** | ç¬¬ 2-3 å‘¨ | context, event-store, cqrs, eda |
| **M3: æ•°æ®è®¿é—®** | ç¬¬ 3-4 å‘¨ | database, messaging |
| **M4: å®‰å…¨å±‚** | ç¬¬ 4-5 å‘¨ | auth, authorization |
| **M5: ç¬¬ä¸€ä¸ªé¢†åŸŸ** | ç¬¬ 5-6 å‘¨ | tenant domain |
| **M6: ç»„è£…å±‚** | ç¬¬ 6-7 å‘¨ | app-kit |
| **M7: åº”ç”¨å…¥å£** | ç¬¬ 7-8 å‘¨ | platform-api |

### 9.2 éªŒæ”¶æ ‡å‡†

æ¯ä¸ªæ¨¡å—å®Œæˆåå¿…é¡»æ»¡è¶³ï¼š

- [ ] `pnpm run lint` é€šè¿‡
- [ ] `pnpm run typecheck` é€šè¿‡
- [ ] `pnpm run test:unit` é€šè¿‡
- [ ] æµ‹è¯•è¦†ç›–ç‡è¾¾æ ‡
- [ ] `pnpm run build` æˆåŠŸ
- [ ] TSDoc ä¸­æ–‡æ³¨é‡Šå®Œæ•´
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡

---

## åã€å¿«é€Ÿå¼€å§‹

### 10.1 ç¯å¢ƒå‡†å¤‡

```bash
# ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Node.js ç‰ˆæœ¬
node --version  # åº”è¯¥æ˜¯ 20+

# å®‰è£…ä¾èµ–
pnpm install

# éªŒè¯æ„å»º
pnpm run build
```

### 10.2 åˆ›å»ºç¬¬ä¸€ä¸ªæ¨¡å—

```bash
# åˆ›å»º kernel æ¨¡å—
mkdir -p libs/shared/kernel/src/lib
mkdir -p libs/shared/kernel/src/spec

# åˆ›å»º package.json
cat > libs/shared/kernel/package.json << 'EOF'
{
  "name": "@oksai/kernel",
  "version": "0.1.0",
  "main": "./dist/index.js",
  "types": "./dist/index.d.ts",
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",
      "import": "./dist/index.js",
      "require": "./dist/index.js"
    }
  }
}
EOF

# å¼€å§‹ TDD å¼€å‘
# 1. å…ˆå†™æµ‹è¯•
# 2. å†å†™å®ç°
# 3. æœ€åé‡æ„
```

---

## ä¿®è®¢å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´è¯´æ˜ |
|:---|:---|:---|
| v1.0 | 2026-02-20 | åˆ›å»ºé‡æ„å·¥ä½œè®¡åˆ’ |
